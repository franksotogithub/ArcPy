# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# CrearAEU_CONDOMINIOS.py
# Created on: 2016-09-20 15:46:18.00000
#   (generated by ArcGIS/ModelBuilder)
# Description: 
# ---------------------------------------------------------------------------

# Set the necessary product code
# import arcinfo


# Import arcpy module
import arcpy


# Local variables:
TB_VIVIENDAS_ORDENADAS_shp = "D:\\ShapesPruebasSegmentacionUrbana\\AEU\\EnumerarAEUViviendas\\TB_VIVIENDAS_ORDENADAS.shp"
TB_VIVIENDAS_ORDENADAS_Layer = "TB_VIVIENDAS_ORDENADAS_Layer"
TB_VIVIENDAS_ORDENADAS_FindI1 = "in_memory\\TB_VIVIENDAS_ORDENADAS_FindI1"
TB_VIVIENDAS_ORDENADAS_Layer__3_ = "TB_VIVIENDAS_ORDENADAS_Layer"
TB_VIVIENDAS_ORDENADAS_Stati = "in_memory\\TB_VIVIENDAS_ORDENADAS_Stati"
TB_VIVIENDAS_ORDENADAS_Layer__4_ = "TB_VIVIENDAS_ORDENADAS_Layer"
TB_AEU_2 = "D:\\ShapesPruebasSegmentacionUrbana\\AEU\\CrearRepresentacionAEU\\TB_AEU_2.shp" # representacion de los aeu y puntos condominios


# Process: Make Feature Layer
arcpy.MakeFeatureLayer_management(TB_VIVIENDAS_ORDENADAS_shp, TB_VIVIENDAS_ORDENADAS_Layer, "", "", "FID FID VISIBLE NONE;Shape Shape VISIBLE NONE;ID ID VISIBLE NONE;UBIGEO UBIGEO VISIBLE NONE;ZONA ZONA VISIBLE NONE;MANZANA MANZANA VISIBLE NONE;NOMCCPP NOMCCPP VISIBLE NONE;DEPARTAMEN DEPARTAMEN VISIBLE NONE;PROVINCIA PROVINCIA VISIBLE NONE;DISTRITO DISTRITO VISIBLE NONE;AREA AREA VISIBLE NONE;FRENTE_ORD FRENTE_ORD VISIBLE NONE;ID_REG_OR ID_REG_OR VISIBLE NONE;EDIFICACIO EDIFICACIO VISIBLE NONE;USOLOCAL USOLOCAL VISIBLE NONE;COND_USOLO COND_USOLO VISIBLE NONE;AEU AEU VISIBLE NONE;OR_VIV_AEU OR_VIV_AEU VISIBLE NONE;FLG_CORTE FLG_CORTE VISIBLE NONE;FLG_MZ FLG_MZ VISIBLE NONE")

# Process: Find Identical
arcpy.FindIdentical_management(TB_VIVIENDAS_ORDENADAS_Layer, TB_VIVIENDAS_ORDENADAS_FindI1, "Shape;UBIGEO;ZONA;MANZANA;AEU", "", "0", "ALL")

# Process: Add Join
arcpy.AddJoin_management(TB_VIVIENDAS_ORDENADAS_Layer, "FID", TB_VIVIENDAS_ORDENADAS_FindI1, "IN_FID", "KEEP_ALL")

# Process: Summary Statistics
arcpy.Statistics_analysis(TB_VIVIENDAS_ORDENADAS_Layer__3_, TB_VIVIENDAS_ORDENADAS_Stati, "TB_VIVIENDAS_ORDENADAS.FID COUNT;TB_VIVIENDAS_ORDENADAS.FID FIRST", "TB_VIVIENDAS_ORDENADAS.UBIGEO;TB_VIVIENDAS_ORDENADAS.ZONA;TB_VIVIENDAS_ORDENADAS.AEU;TB_VIVIENDAS_ORDENADAS_FindI1.FEAT_SEQ")

# Process: Add Join (2)
arcpy.AddJoin_management(TB_VIVIENDAS_ORDENADAS_Layer, "TB_VIVIENDAS_ORDENADAS.FID", TB_VIVIENDAS_ORDENADAS_Stati, "FIRST_TB_VIVIENDAS_ORDENADAS_FID", "KEEP_ALL")

# Process: Select
arcpy.Select_analysis(TB_VIVIENDAS_ORDENADAS_Layer__4_, TB_AEU_2, "TB_VIVIENDAS_ORDENADAS_Stati.COUNT_TB_VIVIENDAS_ORDENADAS_FID>1")

# Process: Add Field
arcpy.AddField_management(TB_AEU_2, "CANT_VIV", "SHORT", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field
arcpy.CalculateField_management(TB_AEU_2, "CANT_VIV", "[TB_VIVIENDAS_ORDENADAS_Stati_COUNT_TB_VIVIENDAS_ORDENADAS_FID]", "VB", "")

# Process: Delete Field
arcpy.DeleteField_management(TB_AEU_2, "TB_VIVIENDAS_ORDENADAS_ID;TB_VIVIENDAS_ORDENADAS_NOMCCPP;TB_VIVIENDAS_ORDENADAS_DEPARTAMEN;TB_VIVIENDAS_ORDENADAS_PROVINCIA;TB_VIVIENDAS_ORDENADAS_DISTRITO;TB_VIVIENDAS_ORDENADAS_AREA;TB_VIVIENDAS_ORDENADAS_FRENTE_ORD;TB_VIVIENDAS_ORDENADAS_ID_REG_OR;TB_VIVIENDAS_ORDENADAS_EDIFICACIO;TB_VIVIENDAS_ORDENADAS_USOLOCAL;TB_VIVIENDAS_ORDENADAS_COND_USOLO;TB_VIVIENDAS_ORDENADAS_OR_VIV_AEU;TB_VIVIENDAS_ORDENADAS_FLG_CORTE;TB_VIVIENDAS_ORDENADAS_FLG_MZ;TB_VIVIENDAS_ORDENADAS_FEAT_SEQ;TB_VIVIENDAS_ORDENADAS_FindI1_OBJECTID;TB_VIVIENDAS_ORDENADAS_FindI1_IN_FID;TB_VIVIENDAS_ORDENADAS_FindI1_FEAT_SEQ;TB_VIVIENDAS_ORDENADAS_Stati_OBJECTID;TB_VIVIENDAS_ORDENADAS_Stati_TB_VIVIENDAS_ORDENADAS_UBIGEO;TB_VIVIENDAS_ORDENADAS_Stati_TB_VIVIENDAS_ORDENADAS_ZONA;TB_VIVIENDAS_ORDENADAS_Stati_TB_VIVIENDAS_ORDENADAS_AEU;TB_VIVIENDAS_ORDENADAS_Stati_TB_VIVIENDAS_ORDENADAS_FindI1_FEAT_;TB_VIVIENDAS_ORDENADAS_Stati_FREQUENCY;TB_VIVIENDAS_ORDENADAS_Stati_COUNT_TB_VIVIENDAS_ORDENADAS_FID;TB_VIVIENDAS_ORDENADAS_Stati_FIRST_TB_VIVIENDAS_ORDENADAS_FID")

